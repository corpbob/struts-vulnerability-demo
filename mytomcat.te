policy_module(mytomcat, 0.1)

gen_require(`
  type passwd_file_t;
  type tomcat_tmp_t;
  type tomcat_cache_t;
  type tomcat_log_t;
  type tomcat_var_lib_t;
')

tomcat_domain_template(mytomcat)
allow mytomcat_t passwd_file_t:file { getattr open read };
allow mytomcat_t self:process execmem;
allow mytomcat_t tomcat_tmp_t:dir write;
allow mytomcat_t tomcat_tmp_t:dir { getattr open read search };
allow mytomcat_t tomcat_tmp_t:dir add_name;
allow mytomcat_t tomcat_tmp_t:file create;
allow mytomcat_t tomcat_tmp_t:file write;
allow mytomcat_t tomcat_tmp_t:dir remove_name;
allow mytomcat_t tomcat_tmp_t:file unlink;

allow mytomcat_t self:tcp_socket listen;
allow mytomcat_t self:tcp_socket accept;
allow mytomcat_t tomcat_cache_t:dir { getattr search };
allow mytomcat_t tomcat_log_t:dir { getattr search write };
allow mytomcat_t tomcat_log_t:dir add_name;
allow mytomcat_t tomcat_log_t:file open;
allow mytomcat_t tomcat_var_lib_t:dir read;
allow mytomcat_t tomcat_var_lib_t:file { getattr read };
allow mytomcat_t tomcat_var_lib_t:file open;

